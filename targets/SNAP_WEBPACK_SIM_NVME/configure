#! /bin/bash

cat > $SNAP_ROOT/snap_env.sh <<- EOF
export PSLVER=8
export TIMING_LABLIMIT="-200"
export ACTION_ROOT=$METAL_ROOT/src/metal_fpga
#export PSL_DCP= <for CAPI1.0 cards: path to b_route_design.dcp file>
export PSLSE_ROOT=$PSLSE_ROOT
EOF

cat > $SNAP_ROOT/defconfig/WEBPACK_SIM.hls_metalfpga.SDRAM.NVME.defconfig <<- EOF
#
# Automatically generated file; DO NOT EDIT.
# Kernel Configuration
#
WEBPACK_SIM=y
# N250S is not set
# ADKU3 is not set
# AD8K5 is not set
# S121B_BPIx16 is not set
# S121B_SPIx4 is not set
# N250SP is not set
# RCXVUP is not set
# S241 is not set
# U200 is not set
# FX609 is not set
# AD9V3 is not set
FPGACARD="WEBPACK_SIM"
FLASH_INTERFACE="BPIx16"
FLASH_SIZE="128"
FLASH_FACTORYADDR="0x00000000"
FLASH_USERADDR="0x02000000"
# S121B is not set
CAPI10=y
# CAPI20 is not set
FPGACHIP="xcku035-ffva1156-2-e"
NUM_OF_ACTIONS=1
HDL_ACTION=y
# HDL_HELLOWORLD is not set
# HDL_EXAMPLE is not set
# HDL_NVME_EXAMPLE is not set
# HLS_ACTION is not set
# HLS_HELLOWORLD is not set
# HLS_MEMCOPY is not set
# HLS_NVME_MEMCOPY is not set
# HLS_SPONGE is not set
# HLS_HASHJOIN is not set
# HLS_SEARCH is not set
# HLS_BFS is not set
# HLS_INTERSECT is not set
# HLS_LATENCY_EVAL is not set
# HLS_MM_TEST is not set
# HLS_DECIMAL_MULT is not set
# HLS_SCATTER_GATHER is not set
# HLS_VECTOR_GENERATOR is not set
# HLS_PARALLEL_MEMCPY is not set
# ENABLE_HLS_SUPPORT is not set
HLS_SUPPORT="FALSE"
# DISABLE_SDRAM_AND_BRAM is not set
FORCE_SDRAM_OR_BRAM=y
FORCE_SDRAM=y
ENABLE_SDRAM=y
SDRAM_USED="TRUE"
# ENABLE_BRAM is not set
BRAM_USED="FALSE"
DDR3_USED="FALSE"
DDR4_USED="FALSE"
ENABLE_DDRI=y
DDRI_USED="TRUE"
# DISABLE_NVME is not set
# FORCE_NVME is not set
ENABLE_NVME=y
NVME_USED="TRUE"
SIM_XSIM=y
# SIM_IRUN is not set
# SIM_XCELIUM is not set
# SIM_MODELSIM is not set
# SIM_QUESTA is not set
# NO_SIM is not set
SIMULATOR="xsim"
DENALI_USED="FALSE"

#
# ================= Advanced Options: =================
#
# ENABLE_PRFLOW is not set
USE_PRFLOW="FALSE"
FPGA_ACTION_CLK="250MHZ"
HLS_CLK_CONSTRAINT="FALSE"
# ENABLE_ILA is not set
ILA_DEBUG="FALSE"
# ENABLE_FACTORY is not set
FACTORY_IMAGE="FALSE"
CLOUD_USER_FLOW="FALSE"
CLOUD_BUILD_BITFILE="FALSE"
EOF

make -C $SNAP_ROOT WEBPACK_SIM.hls_metalfpga.SDRAM.NVME.defconfig <&-
